USE master;
GO

ALTER SERVER AUDIT Audit_TacoDB1
WITH (STATE = ON);
GO

USE master;
GO

ALTER SERVER AUDIT Audit_TacoDB1
WITH (STATE = OFF);
GO
‚úÖ Verify after enabling
sql
Copy code
SELECT name, is_state_enabled
FROM sys.server_audits
WHERE name = 'Audit_TacoDB1';


SELECT
    r.session_id,
    r.status,
    r.wait_type,
    r.wait_time,
    r.command
FROM sys.dm_exec_requests r
WHERE r.command LIKE '%AUDIT%';

SELECT
    name,
    audit_file_path
FROM sys.server_audits
WHERE name = 'Audit_TacoDB1';

/////////////////delete

USE taco_treceability;
GO

ALTER DATABASE AUDIT SPECIFICATION Audit_AllTables1
WITH (STATE = OFF);
GO

DROP DATABASE AUDIT SPECIFICATION Audit_AllTables1;
GO
////////////////////////////////////
USE taco_treceability;
GO

SELECT name, is_state_enabled
FROM sys.database_audit_specifications;

USE master;
GO

ALTER SERVER AUDIT Audit_TacoDB1
WITH (STATE = OFF);
GO

DROP SERVER AUDIT Audit_TacoDB1;
GO

DROP SERVER AUDIT Audit_TacoDB1;
GO

//////////////////////////////////////////////////////////
SELECT name, status_desc, last_error, is_state_enabled
FROM sys.server_audits;

SELECT *
FROM sys.dm_server_audit_status;

SELECT *
FROM sys.dm_os_file_handles
WHERE file_handle LIKE '%SQLAudit%';

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
1Ô∏è‚É£ First check what it is waiting on
Open a new query window and run:
SELECT 
    r.session_id,
    r.status,
    r.command,
    r.wait_type,
    r.wait_time,
    r.blocking_session_id,
    r.cpu_time,
    r.total_elapsed_time
FROM sys.dm_exec_requests r
WHERE r.command LIKE '%AUDIT%' OR r.session_id > 50;

If you see a wait type like:


IO_COMPLETION


AUDIT_QUEUE


LCK_M_X


WRITELOG


then that explains the delay.

2Ô∏è‚É£ Proper way to drop a Server Audit (important)
If the audit is enabled, SQL Server may hang while dropping.
Do this instead:
ALTER SERVER AUDIT Audit_TacoDB1
WITH (STATE = OFF);
GO

DROP SERVER AUDIT Audit_TacoDB1;
GO

‚ö†Ô∏è If you already ran DROP and it‚Äôs hanging, continue below.

3Ô∏è‚É£ Find and kill the blocking session (if any)
Run:
SELECT session_id, blocking_session_id, wait_type, command
FROM sys.dm_exec_requests
WHERE command LIKE '%DROP SERVER AUDIT%';

Note the session_id.
Then:
KILL <session_id>;

Example:
KILL 72;

Then retry using Step 2 (disable first, then drop).

4Ô∏è‚É£ If still hanging ‚Äì check audit file location
Audits write to disk. If disk/network path is slow or unreachable, SQL Server will freeze.
Check:
SELECT name, log_file_path
FROM sys.server_audits
WHERE name = 'Audit_TacoDB1';

If the path is on:


Network drive


Disconnected drive


Full disk


‚Üí that is the root cause.

5Ô∏è‚É£ Last option (safe approach)
Restart SQL Server service (only if allowed in your environment):


This clears the stuck audit handle


Then immediately:


ALTER SERVER AUDIT Audit_TacoDB1 WITH (STATE = OFF);
DROP SERVER AUDIT Audit_TacoDB1;


Quick recommendation for you
Since you work with SQL & Node systems regularly, I‚Äôd suggest:


Cancel the running query


Run:


ALTER SERVER AUDIT Audit_TacoDB1 WITH (STATE = OFF);
DROP SERVER AUDIT Audit_TacoDB1;



If it still hangs ‚Üí check wait type using step #1.



If you want, you can paste:


Output of sys.dm_exec_requests


Or the audit file path


and I can tell you exactly why it‚Äôs slow and how to fix it permanently üëç
