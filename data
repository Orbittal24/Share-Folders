const normalizeStrict = (s) =>
  s
    .toLowerCase()
    .replace(/\s+/g, ' ')
    .replace(/\s*\(\s*/g, '(')
    .replace(/\s*\)\s*/g, ')')
    .trim();



else if (scanType === 'BOM') {
  const inputNorm = normalizeStrict(row.process_name);

  let exactMatch = null;

  for (const p of pmResBom.recordset) {
    const procNorm = normalizeStrict(p.Process_Name);

    // üî• ONLY exact directional match allowed
    if (procNorm === inputNorm) {
      exactMatch = {
        score: 1,
        processID: p.Process_ID,
        totalCount: p.Total_Count,
        scanName: p.Scan_Name,
        processName: p.Process_Name
      };
      break;
    }
  }

  // ‚ùå If no exact match ‚Üí skip row
  if (!exactMatch) {
    console.warn(
      "‚ùå BOM process skipped (no exact directional match):",
      row.process_name
    );
    continue;
  }

  best2 = exactMatch;
}
