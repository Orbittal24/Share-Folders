if (scanType === 'Module') {
    console.log('Module:::::::::::::', row.process_name, moduleName);

    // Extract the module identifier from moduleName (e.g., M1, M2)
    const moduleKey = moduleName.toUpperCase(); // keep case as in DB
    const inputNorm = normalizeProcess(row.process_name);

    for (const p of pmRes.recordset) {
        const dbProcess = p.Process_Name; // keep original casing

        // Check if moduleKey is part of the DB process name
        if (!dbProcess.includes(moduleKey)) continue;

        const cand = normalizeProcess(dbProcess);

        let score = 0;
        if (inputNorm === cand) score = 1;                  // exact match
        else if (cand.startsWith(inputNorm)) score = 0.99;  // starts with
        else if (cand.includes(inputNorm)) score = 0.95;    // contains
        else if (inputNorm.includes(cand)) score = 0.9;     // input contains
        else {
            score = 0.7 * getCommonWordsScore(inputNorm, cand) +
                    0.3 * stringSimilarity.compareTwoStrings(inputNorm, cand);
        }

        if (score > best.score || (score === best.score && dbProcess.length < best.processName.length)) {
            best = { score, processID: p.Process_ID, totalCount: p.Total_Count, scanName: p.Scan_Name, processName: dbProcess };
            console.log('best', best);
        }
    }

    if (!best.processID || best.score < 0.5) continue;
}
