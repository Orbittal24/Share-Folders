else if (message === "Process register updated successfully" && Process_Status === "Completed") {
  try {
    // 1. Extract Process_ID from putUrl
    const processIdMatch = putUrl.match(/Process_ID=(\d+)/);
    const processId = processIdMatch ? processIdMatch[1] : null;

    if (!processId) {
      console.error("Process_ID not found in PUT_url:", putUrl);
    } else {
      console.log("Extracted Process_ID:", processId);

      // 2. Fetch Station_ID from DB
      const stationResult = await pool1
        .request()
        .query(`SELECT Station_ID FROM taco_treceability.Process_Master WHERE Process_ID = '${processId}'`);

      if (stationResult.recordset.length === 0) {
        console.error("No Station_ID found for Process_ID:", processId);
      } else {
        const stationId = stationResult.recordset[0].Station_ID;
        console.log("Fetched Station_ID:", stationId);

        // 3. Build payload for API
        const stationPayload = {
          station_id: stationId,
          line_id: "1",
          customer_qrcode: module_barcode,
          station_status: "OK",
          checklist_name: "NA",
          substation_id: processId
        };

        // Send POST request to station_status/filter API
        try {
          const stationResponse = await axios.post(
            "https://Misapp.tataautocomp.com:5555/station_status/filter",
            stationPayload
          );
          console.log("Station Status API Response:", JSON.stringify(stationResponse.data, null, 2));
        } catch (stationErr) {
          console.error("Error sending Station Status API:", stationErr.message);
          if (stationErr.response) console.error("Station API Error Response:", JSON.stringify(stationErr.response.data, null, 2));
        }
      }
    }

    // 4. Delete record from DB after successful process update
    await pool1.request().query(`DELETE FROM taco_treceability.torque_details_EIP_mirror WHERE sr_no = ${row.sr_no}`);
    console.log(`Deleted sr_no ${row.sr_no} after successful update.`);
    console.log("Pack sr_no complete***:::::::", message, Process_Status);
    return startFetchLoop();
  } catch (innerErr) {
    console.error("Error in Process Completed flow:", innerErr.message);
  }
}
