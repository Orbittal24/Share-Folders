socket.on('setGlobalIngersollData', (ingwholeData, ingpackDAta, pack_noo, pack_name, mod_numb) => {
    console.log("ingwholeData:", ingwholeData);
    console.log("ingpackDAta:", ingpackDAta);

    // pending torque summary array
    let pendingList = [];

    // Loop ingwholeData → this contains expected torque requirements
    for (let i = 0; i < ingwholeData.length; i += 5) {

        let moduleNo    = ingwholeData[i];
        let station     = ingwholeData[i + 1];
        let processName = ingwholeData[i + 2];
        let totalCount  = parseInt(ingwholeData[i + 4]);

        let doneCount = null;

        // find process in actual pack data
        for (let j = 0; j < ingpackDAta.length; j += 4) {

            let packProcessName = ingpackDAta[j + 2];
            let packDoneCount   = parseInt(ingpackDAta[j + 3]);

            if (processName === packProcessName) {
                doneCount = packDoneCount;
                break;
            }
        }

        // If not done OR partially done → add to pending list
        if (doneCount === null || doneCount !== totalCount) {
            pendingList.push({
                module: moduleNo,
                station: station,
                process: processName,
                done: doneCount ?? 0,
                total: totalCount
            });
        }
    }

    console.log("PENDING PROCESSES:", pendingList);

    // If pending torque operations exist → show popup
    if (pendingList.length > 0) {

        // build rows for table
        let tableRows = ``;

        pendingList.forEach(row => {
            tableRows += `
                <tr>
                    <td>${row.station}</td>
                    <td>${row.process}</td>
                    <td>( ${row.done} / ${row.total} )</td>
                    <td>${row.module}</td>
                </tr>
            `;
        });

        Swal.fire({
            title: `IR Torque Pending for ${pack_noo}!`,
            html: `
                <span style='font-size:20px;'>Pending Process:</span>
                <table border="1" width="100%">
                <thead>
                    <tr style="background:#e4eaf5;">
                        <th colspan="4">Incomplete Process</th>
                    </tr>
                    <tr>
                        <th>Station Name</th>
                        <th>Process</th>
                        <th>Status</th>
                        <th>Module</th>
                    </tr>
                </thead>
                <tbody>
                    ${tableRows}
                </tbody>
            </table>`,
            icon: 'info',
            width: 900,
            showConfirmButton: false,
            allowOutsideClick: false,
            allowEscapeKey: false,
            allowEnterKey: false
        });

        // Block next step
        socket.emit("data_blocker", '1');
        return;
    }

    // ELSE → everything matched, continue normal flow
    console.log("All torque processes completed.");
    socket.emit('get_module_count_283_pa_gun1',
        pack_name,
        mod_numb,
        globalProcessName,
        global_module_check
    );
});
