
socket.on("foam_interlock_status", function (foam_numb) {
    console.log("foam_numb length:", foam_numb.length);

    // Function to show beautiful modal
    function showModal(message, callback) {
        // Check if modal already exists
        let modal = document.getElementById("foamModal");
        if (!modal) {
            // Create overlay
            modal = document.createElement("div");
            modal.id = "foamModal";
            modal.style.position = "fixed";
            modal.style.top = "0";
            modal.style.left = "0";
            modal.style.width = "100%";
            modal.style.height = "100%";
            modal.style.background = "rgba(0,0,0,0.5)";
            modal.style.display = "flex";
            modal.style.justifyContent = "center";
            modal.style.alignItems = "center";
            modal.style.zIndex = "9999";

            // Create content box
            const box = document.createElement("div");
            box.style.background = "#fff";
            box.style.padding = "25px 30px";
            box.style.borderRadius = "10px";
            box.style.textAlign = "center";
            box.style.boxShadow = "0 8px 25px rgba(0,0,0,0.3)";
            box.style.maxWidth = "400px";
            box.style.fontFamily = "Arial, sans-serif";
            box.style.display = "flex";
            box.style.flexDirection = "column";
            box.style.justifyContent = "center";

            // Title
            const title = document.createElement("h2");
            title.textContent = "Foam Missing";
            title.style.color = "#e74c3c";
            title.style.marginBottom = "15px";

            // Message
            const msg = document.createElement("p");
            msg.id = "foamModalMessage";
            msg.style.color = "#333";
            msg.style.marginBottom = "20px";

            // OK button
            const btn = document.createElement("button");
            btn.textContent = "OK";
            btn.style.padding = "8px 20px";
            btn.style.border = "none";
            btn.style.background = "#3498db";
            btn.style.color = "#fff";
            btn.style.borderRadius = "5px";
            btn.style.cursor = "pointer";
            btn.style.fontSize = "14px";
            btn.onmouseover = () => btn.style.background = "#2980b9";
            btn.onmouseout = () => btn.style.background = "#3498db";

            btn.onclick = () => {
                modal.style.display = "none";
                if (callback) callback();
            };

            box.appendChild(title);
            box.appendChild(msg);
            box.appendChild(btn);
            modal.appendChild(box);
            document.body.appendChild(modal);
        }

        document.getElementById("foamModalMessage").textContent = message;
        modal.style.display = "flex";
    }

    if (foam_numb.length === 0) {
        // Show beautiful modal and refresh page on OK
        showModal("Foam is not linked with the Pack", () => {
            location.reload();
        });
    } else {
        // Proceed if foam is linked
        console.log("Foam linked, proceeding...", glob_pack, glob_packName);
        socket.emit("getGlobalIngersollData", glob_packName, glob_pack);
    }
});

