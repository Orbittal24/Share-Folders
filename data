if (scanType === 'Module') {
    console.log('Module:::::::::::::', row.process_name, moduleName);

    const inputNorm = normalizeProcess(row.process_name);
    const modKey = moduleName.toLowerCase();

    for (const p of pmRes.recordset) {
        const raw = p.Process_Name.toLowerCase();

        // Only enforce module number if the candidate mentions a module
        const needsModuleMatch = /\bM\d+\b/i.test(p.Process_Name); 
        if (needsModuleMatch && !raw.includes(`m${modKey}`)) continue;

        const cand = normalizeProcess(p.Process_Name);

        // Check for exact match
        if (inputNorm === cand) {
            best = { 
                score: 1,
                processID: p.Process_ID,
                totalCount: p.Total_Count,
                scanName: p.Scan_Name,
                processName: p.Process_Name
            };
            console.log('Exact match found:', best);
            break; // no need to continue, we found exact match
        }
    }

    if (!best.processID) continue;
}
