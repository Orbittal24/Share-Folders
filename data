socket.on("get_foam_interlock", (packName, pack_numb) => {
  console.log("get_foam_interlock:::::::", packName, pack_numb);

  sql.connect(sqlConfig, (err) => {
    if (err) {
      console.error("SQL Connection Error:", err);
      return;
    }

    const request = new sql.Request();
    request.input("pack_numb", sql.VarChar, pack_numb);

    request.query(
      "SELECT foam_no FROM taco_treceability.coral_fom_link_with_pack WHERE pack_no = @pack_numb",
      (err, result) => {
        if (err) {
          console.error("Query Error:", err);
        } else {
          // Convert recordset to array of foam_no strings
          const foamNos = result.recordset.map(row => row.foam_no);

          console.log("Foam Interlock Result:", foamNos);

          socket.emit("foam_interlock_status", foamNos);
        }
      }
    );
  });
});
