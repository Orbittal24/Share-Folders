socket.on('getGlobalIngersollData', async (pack_name, pack_no) => {
    try {
        console.log('pack_name, pack_no:::::::::::', pack_name, pack_no);

        // Step 1: Get pack_id using pack_name
        const apiUrl = `https://Misapp.tataautocomp.com:5555/packs?Pack_Name=${encodeURIComponent(pack_name.trim())}`;

        const response = await fetch(apiUrl, {
            method: "GET",
            headers: {
                "Content-Type": "application/json",
            }
        });

        if (!response.ok) {
            console.error("Pack API error:", response.status, response.statusText);
            return;
        }

        const result = await response.json();
        console.log("Pack API result:", JSON.stringify(result, null, 2));

        // Extract pack_id
        let pack_id = null;
        if (Array.isArray(result) && result.length > 0) {
            pack_id = result[0].pack_id || null;
        }

        if (!pack_id) {
            console.error("No pack_id found for pack_name:", pack_name);
            return;
        }

        console.log("Resolved pack_id:", pack_id);

        // Step 2: Call another API with pack_id
        const secondApiUrl = `https://Misapp.tataautocomp.com:5555/another_endpoint?pack_id=${pack_id}&pack_no=${pack_no}`;

        const secondResponse = await fetch(secondApiUrl, {
            method: "GET",
            headers: {
                "Content-Type": "application/json",
            }
        });

        if (!secondResponse.ok) {
            console.error("Second API error:", secondResponse.status, secondResponse.statusText);
            return;
        }

        const secondResult = await secondResponse.json();
        console.log("Second API result:", JSON.stringify(secondResult, null, 2));

        // You can now use secondResult further (process, save to DB, etc.)

    } catch (error) {
        console.error("Error in getGlobalIngersollData:", error.message);
    }
});
